\section{Dataset Artificial}
\label{sec:datasetArtificial}

El banco de animaciones en el que fueron buscados los gestos necesarios fue Mixamo. \footnote{Página web de Mixamo: \url{https://www.mixamo.com}}

Mixamo es una página web creada por Adobe en la que se encuntran de manera gratuita modelos con un \gls{rig} humanoide y animaciones para estos rigs, además de una funcionalidad que permite crear el \gls{rig} de un personaje que se suba a la página.
En la página hay un buscador en el que puedes buscar tipos de animaciones, pero como no es viable descargarse todas las animaciones de todos los gestos buscados se usó una herramienta para automatizarlo.

\subsection{Herramienta para descargarse animaciones de Mixamo de forma automática}

TO DO: HABLAR DE LA HERRAMIENTA ENCONTRADA Y PERSONALIZADA

Las animaciones descargadas tienen un formato \gls{FBX}, por lo que era necesario pasarlas a un formato que puedan usar los modelos de \gls{ia}.
Para ello se decidió pasar la información relevante de los huesos en la toda la animación (su posición y rotación en cada frame) a un archivo CSV, donde cada columna iba a ser esta información y cada fila un frame de la animación. En la tabla \ref{tab:cabecera-csv} se puede ver la cabecera para los CSV

\begin{longtblr}[
    caption={Cabecera del \gls{csv} de cada animación, en órden descendente y de izquierda a derecha},
    label={tab:cabecera-csv}
]{
    colspec={|l|l|l|},
    rowhead=1,
    hlines,
    row{even}={gray9},
    cells   = {font=\footnotesize\linespread{0.84}\selectfont},
}
Robot\_Hips\_posx             &
Robot\_Hips\_posy             &
Robot\_Hips\_posz               \\
Robot\_Hips\_rotx             &
Robot\_Hips\_roty             &
Robot\_Hips\_rotz               \\
Robot\_LeftUpLeg\_posx        &
Robot\_LeftUpLeg\_posy        &
Robot\_LeftUpLeg\_posz          \\
Robot\_LeftUpLeg\_rotx        &
Robot\_LeftUpLeg\_roty        &
Robot\_LeftUpLeg\_rotz          \\
Robot\_LeftLeg\_posx          &
Robot\_LeftLeg\_posy          &
Robot\_LeftLeg\_posz            \\
Robot\_LeftLeg\_rotx          &
Robot\_LeftLeg\_roty          &
Robot\_LeftLeg\_rotz            \\
Robot\_LeftFoot\_posx         &
Robot\_LeftFoot\_posy         &
Robot\_LeftFoot\_posz           \\
Robot\_LeftFoot\_rotx         &
Robot\_LeftFoot\_roty         &
Robot\_LeftFoot\_rotz           \\
Robot\_RightUpLeg\_posx       &
Robot\_RightUpLeg\_posy       &
Robot\_RightUpLeg\_posz         \\
Robot\_RightUpLeg\_rotx       &
Robot\_RightUpLeg\_roty       &
Robot\_RightUpLeg\_rotz         \\
Robot\_RightLeg\_posx         &
Robot\_RightLeg\_posy         &
Robot\_RightLeg\_posz           \\
Robot\_RightLeg\_rotx         &
Robot\_RightLeg\_roty         &
Robot\_RightLeg\_rotz           \\
Robot\_RightFoot\_posx        &
Robot\_RightFoot\_posy        &
Robot\_RightFoot\_posz          \\
Robot\_RightFoot\_rotx        &
Robot\_RightFoot\_roty        &
Robot\_RightFoot\_rotz          \\
Robot\_Spine\_posx            &
Robot\_Spine\_posy            &
Robot\_Spine\_posz              \\
Robot\_Spine\_rotx            &
Robot\_Spine\_roty            &
Robot\_Spine\_rotz              \\
Robot\_Spine1\_posx           &
Robot\_Spine1\_posy           &
Robot\_Spine1\_posz             \\
Robot\_Spine1\_rotx           &
Robot\_Spine1\_roty           &
Robot\_Spine1\_rotz             \\
Robot\_Spine2\_posx           &
Robot\_Spine2\_posy           &
Robot\_Spine2\_posz             \\
Robot\_Spine2\_rotx           &
Robot\_Spine2\_roty           &
Robot\_Spine2\_rotz             \\
Robot\_LeftShoulder\_posx     &
Robot\_LeftShoulder\_posy     &
Robot\_LeftShoulder\_posz       \\
Robot\_LeftShoulder\_rotx     &
Robot\_LeftShoulder\_roty     &
Robot\_LeftShoulder\_rotz       \\
Robot\_LeftArm\_posx          &
Robot\_LeftArm\_posy          &
Robot\_LeftArm\_posz            \\
Robot\_LeftArm\_rotx          &
Robot\_LeftArm\_roty          &
Robot\_LeftArm\_rotz            \\
Robot\_LeftForeArm\_posx      &
Robot\_LeftForeArm\_posy      &
Robot\_LeftForeArm\_posz        \\
Robot\_LeftForeArm\_rotx      &
Robot\_LeftForeArm\_roty      &
Robot\_LeftForeArm\_rotz        \\
Robot\_LeftHand\_posx         &
Robot\_LeftHand\_posy         &
Robot\_LeftHand\_posz           \\
Robot\_LeftHand\_rotx         &
Robot\_LeftHand\_roty         &
Robot\_LeftHand\_rotz           \\
Robot\_LeftHandIndex1\_posx   &
Robot\_LeftHandIndex1\_posy   &
Robot\_LeftHandIndex1\_posz     \\
Robot\_LeftHandIndex1\_rotx   &
Robot\_LeftHandIndex1\_roty   &
Robot\_LeftHandIndex1\_rotz     \\
Robot\_LeftHandIndex2\_posx   &
Robot\_LeftHandIndex2\_posy   &
Robot\_LeftHandIndex2\_posz     \\
Robot\_LeftHandIndex2\_rotx   &
Robot\_LeftHandIndex2\_roty   &
Robot\_LeftHandIndex2\_rotz     \\
Robot\_LeftHandIndex3\_posx   &
Robot\_LeftHandIndex3\_posy   &
Robot\_LeftHandIndex3\_posz     \\
Robot\_LeftHandIndex3\_rotx   &
Robot\_LeftHandIndex3\_roty   &
Robot\_LeftHandIndex3\_rotz     \\
Robot\_LeftHandMiddle1\_posx  &
Robot\_LeftHandMiddle1\_posy  &
Robot\_LeftHandMiddle1\_posz    \\
Robot\_LeftHandMiddle1\_rotx  &
Robot\_LeftHandMiddle1\_roty  &
Robot\_LeftHandMiddle1\_rotz    \\
Robot\_LeftHandMiddle2\_posx  &
Robot\_LeftHandMiddle2\_posy  &
Robot\_LeftHandMiddle2\_posz    \\
Robot\_LeftHandMiddle2\_rotx  &
Robot\_LeftHandMiddle2\_roty  &
Robot\_LeftHandMiddle2\_rotz    \\
Robot\_LeftHandMiddle3\_posx  &
Robot\_LeftHandMiddle3\_posy  &
Robot\_LeftHandMiddle3\_posz    \\
Robot\_LeftHandMiddle3\_rotx  &
Robot\_LeftHandMiddle3\_roty  &
Robot\_LeftHandMiddle3\_rotz    \\
Robot\_LeftHandPinky1\_posx   &
Robot\_LeftHandPinky1\_posy   &
Robot\_LeftHandPinky1\_posz     \\
Robot\_LeftHandPinky1\_rotx   &
Robot\_LeftHandPinky1\_roty   &
Robot\_LeftHandPinky1\_rotz     \\
Robot\_LeftHandPinky2\_posx   &
Robot\_LeftHandPinky2\_posy   &
Robot\_LeftHandPinky2\_posz     \\
Robot\_LeftHandPinky2\_rotx   &
Robot\_LeftHandPinky2\_roty   &
Robot\_LeftHandPinky2\_rotz     \\
Robot\_LeftHandPinky3\_posx   &
Robot\_LeftHandPinky3\_posy   &
Robot\_LeftHandPinky3\_posz     \\
Robot\_LeftHandPinky3\_rotx   &
Robot\_LeftHandPinky3\_roty   &
Robot\_LeftHandPinky3\_rotz     \\
Robot\_LeftHandRing1\_posx    &
Robot\_LeftHandRing1\_posy    &
Robot\_LeftHandRing1\_posz      \\
Robot\_LeftHandRing1\_rotx    &
Robot\_LeftHandRing1\_roty    &
Robot\_LeftHandRing1\_rotz      \\
Robot\_LeftHandRing2\_posx    &
Robot\_LeftHandRing2\_posy    &
Robot\_LeftHandRing2\_posz      \\
Robot\_LeftHandRing2\_rotx    &
Robot\_LeftHandRing2\_roty    &
Robot\_LeftHandRing2\_rotz      \\
Robot\_LeftHandRing3\_posx    &
Robot\_LeftHandRing3\_posy    &
Robot\_LeftHandRing3\_posz      \\
Robot\_LeftHandRing3\_rotx    &
Robot\_LeftHandRing3\_roty    &
Robot\_LeftHandRing3\_rotz      \\
Robot\_LeftHandThumb1\_posx   &
Robot\_LeftHandThumb1\_posy   &
Robot\_LeftHandThumb1\_posz     \\
Robot\_LeftHandThumb1\_rotx   &
Robot\_LeftHandThumb1\_roty   &
Robot\_LeftHandThumb1\_rotz     \\
Robot\_LeftHandThumb2\_posx   &
Robot\_LeftHandThumb2\_posy   &
Robot\_LeftHandThumb2\_posz     \\
Robot\_LeftHandThumb2\_rotx   &
Robot\_LeftHandThumb2\_roty   &
Robot\_LeftHandThumb2\_rotz     \\
Robot\_LeftHandThumb3\_posx   &
Robot\_LeftHandThumb3\_posy   &
Robot\_LeftHandThumb3\_posz     \\
Robot\_LeftHandThumb3\_rotx   &
Robot\_LeftHandThumb3\_roty   &
Robot\_LeftHandThumb3\_rotz     \\
Robot\_Neck\_posx             &
Robot\_Neck\_posy             &
Robot\_Neck\_posz               \\
Robot\_Neck\_rotx             &
Robot\_Neck\_roty             &
Robot\_Neck\_rotz               \\
Robot\_Head\_posx             &
Robot\_Head\_posy             &
Robot\_Head\_posz               \\
Robot\_Head\_rotx             &
Robot\_Head\_roty             &
Robot\_Head\_rotz               \\
Robot\_RightShoulder\_posx    &
Robot\_RightShoulder\_posy    &
Robot\_RightShoulder\_posz      \\
Robot\_RightShoulder\_rotx    &
Robot\_RightShoulder\_roty    &
Robot\_RightShoulder\_rotz      \\
Robot\_RightArm\_posx         &
Robot\_RightArm\_posy         &
Robot\_RightArm\_posz           \\
Robot\_RightArm\_rotx         &
Robot\_RightArm\_roty         &
Robot\_RightArm\_rotz           \\
Robot\_RightForeArm\_posx     &
Robot\_RightForeArm\_posy     &
Robot\_RightForeArm\_posz       \\
Robot\_RightForeArm\_rotx     &
Robot\_RightForeArm\_roty     &
Robot\_RightForeArm\_rotz       \\
Robot\_RightHand\_posx        &
Robot\_RightHand\_posy        &
Robot\_RightHand\_posz          \\
Robot\_RightHand\_rotx        &
Robot\_RightHand\_roty        &
Robot\_RightHand\_rotz          \\
Robot\_RightHandIndex1\_posx  &
Robot\_RightHandIndex1\_posy  &
Robot\_RightHandIndex1\_posz    \\
Robot\_RightHandIndex1\_rotx  &
Robot\_RightHandIndex1\_roty  &
Robot\_RightHandIndex1\_rotz    \\
Robot\_RightHandIndex2\_posx  &
Robot\_RightHandIndex2\_posy  &
Robot\_RightHandIndex2\_posz    \\
Robot\_RightHandIndex2\_rotx  &
Robot\_RightHandIndex2\_roty  &
Robot\_RightHandIndex2\_rotz    \\
Robot\_RightHandIndex3\_posx  &
Robot\_RightHandIndex3\_posy  &
Robot\_RightHandIndex3\_posz    \\
Robot\_RightHandIndex3\_rotx  &
Robot\_RightHandIndex3\_roty  &
Robot\_RightHandIndex3\_rotz    \\
Robot\_RightHandMiddle1\_posx &
Robot\_RightHandMiddle1\_posy &
Robot\_RightHandMiddle1\_posz   \\
Robot\_RightHandMiddle1\_rotx &
Robot\_RightHandMiddle1\_roty &
Robot\_RightHandMiddle1\_rotz   \\
Robot\_RightHandMiddle2\_posx &
Robot\_RightHandMiddle2\_posy &
Robot\_RightHandMiddle2\_posz   \\
Robot\_RightHandMiddle2\_rotx &
Robot\_RightHandMiddle2\_roty &
Robot\_RightHandMiddle2\_rotz   \\
Robot\_RightHandMiddle3\_posx &
Robot\_RightHandMiddle3\_posy &
Robot\_RightHandMiddle3\_posz   \\
Robot\_RightHandMiddle3\_rotx &
Robot\_RightHandMiddle3\_roty &
Robot\_RightHandMiddle3\_rotz   \\
Robot\_RightHandPinky1\_posx  &
Robot\_RightHandPinky1\_posy  &
Robot\_RightHandPinky1\_posz    \\
Robot\_RightHandPinky1\_rotx  &
Robot\_RightHandPinky1\_roty  &
Robot\_RightHandPinky1\_rotz    \\
Robot\_RightHandPinky2\_posx  &
Robot\_RightHandPinky2\_posy  &
Robot\_RightHandPinky2\_posz    \\
Robot\_RightHandPinky2\_rotx  &
Robot\_RightHandPinky2\_roty  &
Robot\_RightHandPinky2\_rotz    \\
Robot\_RightHandPinky3\_posx  &
Robot\_RightHandPinky3\_posy  &
Robot\_RightHandPinky3\_posz    \\
Robot\_RightHandPinky3\_rotx  &
Robot\_RightHandPinky3\_roty  &
Robot\_RightHandPinky3\_rotz    \\
Robot\_RightHandRing1\_posx   &
Robot\_RightHandRing1\_posy   &
Robot\_RightHandRing1\_posz     \\
Robot\_RightHandRing1\_rotx   &
Robot\_RightHandRing1\_roty   &
Robot\_RightHandRing1\_rotz     \\
Robot\_RightHandRing2\_posx   &
Robot\_RightHandRing2\_posy   &
Robot\_RightHandRing2\_posz     \\
Robot\_RightHandRing2\_rotx   &
Robot\_RightHandRing2\_roty   &
Robot\_RightHandRing2\_rotz     \\
Robot\_RightHandRing3\_posx   &
Robot\_RightHandRing3\_posy   &
Robot\_RightHandRing3\_posz     \\
Robot\_RightHandRing3\_rotx   &
Robot\_RightHandRing3\_roty   &
Robot\_RightHandRing3\_rotz     \\
Robot\_RightHandThumb1\_posx  &
Robot\_RightHandThumb1\_posy  &
Robot\_RightHandThumb1\_posz    \\
Robot\_RightHandThumb1\_rotx  &
Robot\_RightHandThumb1\_roty  &
Robot\_RightHandThumb1\_rotz    \\
Robot\_RightHandThumb2\_posx  &
Robot\_RightHandThumb2\_posy  &
Robot\_RightHandThumb2\_posz    \\
Robot\_RightHandThumb2\_rotx  &
Robot\_RightHandThumb2\_roty  &
Robot\_RightHandThumb2\_rotz    \\
Robot\_RightHandThumb3\_posx  &
Robot\_RightHandThumb3\_posy  &
Robot\_RightHandThumb3\_posz    \\
Robot\_RightHandThumb3\_rotx  &
Robot\_RightHandThumb3\_roty  &
Robot\_RightHandThumb3\_rotz    \\
\end{longtblr}

Como no es viable ni escalable meter todas las animaciones a un proyecto de Unity ni crear un \gls{Animator} con todas estas se ideó una herramienta en Unity que se metiese todas las animaciones y contruía el Animator en tiempo de ejecución.

\subsection{Carga mediante asset bundles}
En un principio se pensó en usar los assets bundles para cargar las animaciones.
Los assets bundles son archivos de Unity que contienen archivos serializados (cualquier asset para un videojuego menos código) y pueden cargarse en tiempo de ejecución.
Finalmente se descartó la idea de usar este tipo de archivos, ya que necesitan construirse en un proyecto de Unity, por lo que no solucionaba el problema de meter las animaciones a mano a un proyecto de Unity

\subsection{Carga mediante Asset Database}
Finalmente se decidió usar Asset Database para la carga automática de las animaciones.
Asset Database es una API de Unity que permiten trabajar con assets, siempre y cuando estén incluídos en el proyecto aunque no necesariamente cargados.
Para suplir la condición de que estuviesen incluídos en el proyecto se hizo un script que descargaba las animaciones, separadas por carpetas cuyo nombre era el tipo de gesto, desde la base de datos de Kaggle hacia la carpeta ''Resources'' del proyecto y ejecutaba desde línea de comandos el editor del proyecto.

Una vez las animaciones estuviesen descargadas en la carpeta de ''Resources'' del proyecto se busca iterativamente por la carpeta para cargar las animaciones y guardarse la relación entre el tipo de gesto y la animación.
Una vez completado empieza la ejecución de las animaciones.

Esta ejecución consiste en cargar la animación en la máquina de estados del \gls{Animator} gracias a un componente llamado ''Animator Override Controller'', que permite cambiar el clip de animación de una instancia del \gls{Animator} sin cambiar la lógica de su máquina de estados.
Cuando empieza la animación se crea un CSV con el formato ''Animación\_Número de animación.csv'' y empieza su ejecución.
Una vez finalizada la ejecución de una animación se cierra el CSV y se busca la siguiente animación.

(PONER FOTO DE REMY BAILANDO)

En la figura \ref{fig:MixamoDumper} se puede ver un diagrama de flujo del funcionamiento de esta herramienta.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\textwidth]{Imagenes/Vectorial/FlujoMixamoDumper.pdf}
	\caption{Diagrama de flujo de la herramienta que carga y ejecuta las animaciones de Mixamo en tiempo de ejecución, llamada Mixamo Dumper}
	\label{fig:MixamoDumper}
\end{figure}

Al finalizar todas las animaciones se cierra el editor de Unity y se procesan los CSV resultantes.

La ventaja de hacer esta herramienta es que es independiente del número de gestos y de animaciones por cada gesto, lo que hace que esta herramienta haga escalable el caso de que se quieran introducir o quitar gestos.

\subsection{Tratamiento de CSV resultantes}

TO DO: SECCIÓN POR HACER